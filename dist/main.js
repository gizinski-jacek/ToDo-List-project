(()=>{"use strict";const e=document.getElementById("containerFolders"),t=document.getElementById("containerToDos"),l=document.getElementById("dropdownFolders"),a=document.getElementById("Inbox"),n=document.getElementById("Today"),o=document.getElementById("Week"),d=document.getElementById("newItem"),i=(document.getElementById("header"),document.getElementById("modalNewPage")),r=document.getElementById("modalEditToDo"),s=document.getElementById("modalEditFolder"),c=(document.getElementById("modalNewMenu"),document.getElementById("modalNewToDo")),u=document.getElementById("modalNewFolder"),m=document.getElementById("newToDoBtn"),p=document.getElementById("newFolderBtn"),g=document.querySelectorAll(".confirm"),y=document.querySelectorAll(".confirmEdit"),E=document.querySelectorAll(".cancel"),h=document.querySelectorAll(".button-X"),f=document.getElementById("editToDo"),v=document.getElementById("editFolder"),D=document.querySelectorAll(".selectList");d.onclick=()=>{I(i),c.style.display="flex"},m.onclick=()=>{I(i),c.style.display="flex"},p.onclick=()=>{I(i),u.style.display="flex"},window.onclick=e=>{let t=e.target==i,l=e.target==r,a=e.target==s;(t||l||a)&&I()},h.forEach((e=>{e.onclick=()=>{I()}})),E.forEach((e=>{e.onclick=()=>{I(),H()}}));const I=e=>{i.style.display="none",c.style.display="none",u.style.display="none",r.style.display="none",s.style.display="none",void 0!==e&&(e.style.display="flex")};g.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;""==t[0].value?alert("No ToDo name provided!"):"modalNewToDo"==t.id?Q.find((e=>e.title===t[0].value))?alert("ToDo already exists! Provide unique name."):F(t):"modalNewFolder"==t.id&&(U.find((e=>e.title===t[0].value))?alert("Folder already exists! Provide unique name."):L(t))}})),y.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;""==t[0].value?alert("No ToDo name provided!"):"editToDo"==t.id?w(t):"editFolder"==t.id&&T(t)}}));const w=e=>{let t=e.className.split("__"),l=Q.findIndex((e=>e.title===t[0]&&e.targetFolder===t[1]));Q[l].updateAllData(e[0].value,e[1].value,e[2].value,e[3].value,e[4].value),x(),M()},T=e=>{let t=U.findIndex((t=>t.title===e.className));U[t].updateTitle=e[0].value,Q.forEach((t=>{t.targetFolder===e.className&&(t.updateTargetFolder=e[0].value)})),k(e[0].value),B(),x(),M()};a.addEventListener("click",(e=>{k(e.target.id),x()})),n.addEventListener("click",(e=>{k(e.target.id),x()})),o.addEventListener("click",(e=>{k(e.target.id),x()})),l.onclick=()=>{e.classList.toggle("show")};const F=e=>{let t=e[0].value,l=e[1].value,a=e[2].value,n=e[3].value,o=e[4].value;S(a)&&(new j(t,l,a,n,o),x(),M())},S=e=>{let t=e.split(/[\s\,\.\-]+/),l=t[0],a=t[1].padStart(2,0),n=t[2].padStart(2,0),o=new Date;return null==l||null==a||null==n?(alert("Wrong date format"),!1):l<o.getFullYear()||l>9999?(alert("Wrong year"),!1):a<1||a>12?(alert("Wrong month"),!1):!(n<1||n>new Date(l,a,0).getDate())||(alert("Wrong day"),!1)},L=e=>{new R(e[0].value),W(),B(),M()},B=()=>{e.innerHTML="",U.forEach((t=>{e.append(q(t))}))},x=()=>{t.innerHTML="";let e=document.createElement("h3");e.textContent=b,t.append(e),N().forEach((e=>{t.append(A(e))}))};let b=t.className;const k=e=>{t.className=e,b=e},N=()=>{let e=new Date,t=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0],l=[];return"Inbox"===b?Q:"Today"===b?(l=Q.filter((e=>e.dueDate==t)),l):(l=Q.filter((e=>e.targetFolder===b)),l)},_=e=>{let t=document.createElement("p");return t.textContent=e,t},A=e=>{let t=document.createElement("div");t.id="todo__"+e.title+"__"+e.targetFolder,t.classList.add("todo","priority"+e.priority),t.addEventListener("click",(e=>{e.currentTarget.querySelectorAll(".moreDetails")[0].classList.toggle("show")}));let l=document.createElement("div");l.classList.add("fewDetails");let a=document.createElement("div");a.append(_(e.dueDate)),a.append(_(e.title));let n=document.createElement("div");n.classList.add("controls"),n.append(O()),n.append(C()),l.append(a),l.append(n);let o=document.createElement("div");return o.classList.add("moreDetails"),o.append(_(e.description)),o.append(_("Folder: "+e.targetFolder)),t.append(l),t.append(o),t},q=e=>{let t=document.createElement("div");t.id="folder__"+e.title,t.textContent=e.title,t.classList.add("folder"),t.addEventListener("click",(()=>{k(e.title),x()}));let l=document.createElement("div");return l.classList.add("controls"),l.append(O()),l.append(C()),t.append(l),t},C=()=>{const e=document.createElement("input");return e.setAttribute("type","image"),e.classList.add("deleteBtn"),e.src="imgs/delete-64.png",e.alt="Delete",e.addEventListener("click",(e=>{P(e.target.closest(".folder, .todo")),z(),e.stopPropagation()})),e},O=()=>{const e=document.createElement("input");return e.setAttribute("type","image"),e.classList.add("editBtn"),e.src="imgs/edit-64.png",e.alt="Edit",e.addEventListener("click",(e=>{J(e.target.closest(".folder, .todo")),z(),e.stopPropagation()})),e},H=()=>{document.querySelectorAll("form").forEach((e=>{e.reset()}))},M=()=>{z(),I(),H()},P=e=>{let t=e.id.split("__");if("todo"==t[0]){let e=Q.findIndex((e=>e.title===t[1]&&e.targetFolder===t[2]));Q.splice(e,1)}else if("folder"==t[0]){let e=U.findIndex((e=>e.title===t[1]));U.splice(e,1)}e.remove()},J=e=>{let t=e.id.split("__");if("todo"==t[0]){let e=Q.find((e=>e.title===t[1]&&e.targetFolder===t[2]));G(e),r.style.display="flex",f.className=t[1]+"__"+t[2]}else if("folder"==t[0]){let e=U.find((e=>e.title===t[1]));K(e),s.style.display="flex",v.className=t[1]}},W=()=>{D.forEach((e=>{e.innerHTML="";let t=document.createElement("option");t.value="Inbox",t.textContent="Inbox",e.append(t),U.forEach((t=>{let l=document.createElement("option");l.value=t.title,l.textContent=t.title,e.append(l)}))}))},G=e=>{f[0].value=e.title,f[1].value=e.description,f[2].value=e.dueDate,f[3].value=e.priority,W()},K=e=>{v[0].value=e.title};class R{constructor(e){this.title=e,U.push(this),Y()}set updateTitle(e){this.title=e}}class j{constructor(e,t,l,a,n){this.title=e,this.description=t,this.priority=a,this.dueDate=l,this.targetFolder=n,Q.push(this),X()}set updateTitle(e){this.title=e}set updateDescription(e){this.description=e}set updatePriority(e){this.priority=e}set updateDueDate(e){this.dueDate=e}set updateTargetFolder(e){this.targetFolder=e}updateAllData(e,t,l,a,n){this.updateTitle=e,this.updateDescription=t,this.updateDueDate=l,this.updatePriority=a,this.targetFolder=n}}const z=()=>{X(),Y()},X=()=>{localStorage.setItem("libraryToDos",JSON.stringify(Q))},Y=()=>{localStorage.setItem("libraryFolders",JSON.stringify(U))},Q=JSON.parse(localStorage.getItem("libraryToDos"))||[],U=JSON.parse(localStorage.getItem("libraryFolders"))||[],V=()=>{new R("Kitchen"),new R("House"),new R("Gym"),new j("Jake Mail","Send Email to Jake about upcoming project","2025-01-01","High","Inbox"),new j("Basement","Clean trash from basement","2027-02-02","Medium","House"),new j("Lightbulb","Replace kitchen lightbulb","2021-06-08","Low","Kitchen"),new j("Carpet","Clean the carpet",(new Date).toISOString().split("T")[0],"Low","House"),new j("Gym","Renew gym membership",(new Date).toISOString().split("T")[0],"Medium","Gym")};localStorage.getItem("libraryToDos")||localStorage.getItem("libraryFolders")||V(),0===Q.length&&0===U.length&&V(),B(),x(),H(),W()})();