(()=>{"use strict";const e=document.getElementById("Inbox"),t=document.getElementById("Today"),l=document.getElementById("Week"),o=document.getElementById("containerToDos"),d=document.getElementById("containerFolders"),n=document.getElementById("dropdownFolders"),a=document.getElementById("newItem"),i=document.getElementById("newToDoBtn"),r=document.getElementById("newFolderBtn"),s=document.getElementById("modalNew"),c=document.getElementById("modalNewToDo"),u=document.getElementById("modalNewFolder"),m=document.getElementById("modalEditToDo"),p=document.getElementById("modalEditFolder"),g=document.querySelectorAll(".confirmNew"),y=document.querySelectorAll(".confirmEdit"),E=document.querySelectorAll(".cancel"),v=document.querySelectorAll(".button-X"),f=document.getElementById("editToDo"),I=document.getElementById("editFolder"),h=document.querySelectorAll(".selectList"),D=document.getElementById("newToDoTitle"),T=document.getElementById("newToDoDescription"),w=document.getElementById("newDueDate"),B=document.getElementById("newPriority"),F=document.getElementById("newTargetFolder"),x=document.getElementById("newFolderTitle"),L=document.getElementById("editToDoTitle"),S=document.getElementById("editToDoDescription"),b=document.getElementById("editDueDate"),k=document.getElementById("editPriority"),N=document.getElementById("editTargetFolder"),_=document.getElementById("editFolderTitle");let A;const q=(e="Inbox")=>{o.className=e,A=e};a.onclick=()=>{C(s),c.style.display="flex"},i.onclick=()=>{C(s),c.style.display="flex"},r.onclick=()=>{C(s),u.style.display="flex"},window.onclick=e=>{let t=e.target==s,l=e.target==m,o=e.target==p;(t||l||o)&&C()},v.forEach((e=>{e.onclick=()=>{C()}})),E.forEach((e=>{e.onclick=()=>{C(),j()}}));const C=e=>{s.style.display="none",c.style.display="none",u.style.display="none",m.style.display="none",p.style.display="none",void 0!==e&&(e.style.display="flex")};e.addEventListener("click",(e=>{q(e.target.id),M()})),t.addEventListener("click",(e=>{q(e.target.id),M()})),l.addEventListener("click",(e=>{q(e.target.id),M()})),n.onclick=()=>{d.classList.toggle("show")},y.forEach((e=>{e.onclick=e=>{e.target.closest("form")==f&&(""==L.value?alert("No title provided!"):""==b.value?alert("No date provided!"):O()),e.target.closest("form")==I&&(""==_.value?alert("No title provided!"):P())}}));const O=()=>{let e=f.className.split("__"),t=le.findIndex((t=>t.title===e[0]&&t.targetFolder===e[1]));le[t].updateAllData(L.value,S.value,b.value,k.value,N.value),M(),z()},P=()=>{let e=oe.findIndex((e=>e.title===I.className));oe[e].updateTitle=_.value,le.forEach((e=>{e.targetFolder===I.className&&(e.updateTargetFolder=_.value)})),M(),G(),z()};g.forEach((e=>{e.onclick=e=>{e.target.closest("form")==c&&(""==D.value?alert("No title provided!"):""==w.value?alert("No date provided!"):le.find((e=>e.title===D.value))?alert("ToDo already exists! Provide unique title."):H()),e.target.closest("form")==u&&(""==x.value?alert("No title provided!"):oe.find((e=>e.title===x.value))?alert("Folder already exists! Provide unique title."):J())}}));const H=()=>{let e=D.value,t=T.value,l=w.value,o=B.value,d=F.value;new Y(e,t,l,o,d),M(),z()},J=()=>{new Z(x.value),R(),G(),z()},M=()=>{o.innerHTML="";let e=document.createElement("h3");e.textContent=A,o.append(e),K().forEach((e=>{o.append(X(e))}))},G=()=>{d.innerHTML="",oe.forEach((e=>{d.append(Q(e))}))},K=()=>{let e=new Date,t=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0],l=[];return"Inbox"===A?le:"Today"===A?(l=le.filter((e=>e.dueDate==t)),l):(l=le.filter((e=>e.targetFolder===A)),l)},R=()=>{h.forEach((e=>{e.innerHTML="";let t=document.createElement("option");t.value="Inbox",t.textContent="Inbox",e.append(t),oe.forEach((t=>{let l=document.createElement("option");l.value=t.title,l.textContent=t.title,e.append(l)}))}))},j=()=>{document.querySelectorAll("form").forEach((e=>{e.reset()}))},z=()=>{te(),C(),j()},W=e=>{let t=document.createElement("p");return t.textContent=e,t},X=e=>{let t=document.createElement("div");t.id="todo__"+e.title+"__"+e.targetFolder,t.classList.add("todo","priority"+e.priority),t.addEventListener("click",(e=>{e.currentTarget.querySelectorAll(".moreDetails")[0].classList.toggle("show")}));let l=document.createElement("div");l.classList.add("fewDetails");let o=document.createElement("div");o.append(W(e.dueDate)),o.append(W(e.title));let d=document.createElement("div");d.classList.add("controls"),d.append(V()),d.append(U()),l.append(o),l.append(d);let n=document.createElement("div");return n.classList.add("moreDetails"),n.append(W(e.description)),n.append(W("Folder: "+e.targetFolder)),t.append(l),t.append(n),t},Q=e=>{let t=document.createElement("div");t.id="folder__"+e.title,t.textContent=e.title,t.classList.add("folder"),t.addEventListener("click",(()=>{q(e.title),M()}));let l=document.createElement("div");return l.classList.add("controls"),l.append(V()),l.append(U()),t.append(l),t},U=()=>{const e=document.createElement("input");return e.setAttribute("type","image"),e.classList.add("deleteBtn"),e.src="imgs/delete-64.png",e.alt="Delete",e.addEventListener("click",(e=>{(e=>{let t=e.id.split("__");if("todo"==t[0]){let e=le.findIndex((e=>e.title===t[1]&&e.targetFolder===t[2]));le.splice(e,1)}else if("folder"==t[0]){let e=oe.findIndex((e=>e.title===t[1]));oe.splice(e,1),le.forEach((e=>{e.targetFolder===t[1]&&(e.updateTargetFolder="Inbox")}))}te(),R(),M(),G()})(e.target.closest(".folder, .todo")),e.stopPropagation()})),e},V=()=>{const e=document.createElement("input");return e.setAttribute("type","image"),e.classList.add("editBtn"),e.src="imgs/edit-64.png",e.alt="Edit",e.addEventListener("click",(e=>{(e=>{let t=e.id.split("__");if("todo"==t[0]){let e=le.find((e=>e.title===t[1]&&e.targetFolder===t[2]));l=e,L.value=l.title,S.value=l.description,b.value=l.dueDate,k.value=l.priority,m.style.display="flex",f.className=t[1]+"__"+t[2]}else if("folder"==t[0]){(e=>{_.value=e.title})(oe.find((e=>e.title===t[1]))),p.style.display="flex",I.className=t[1]}var l;te(),R(),M(),G()})(e.target.closest(".folder, .todo")),e.stopPropagation()})),e};class Y{constructor(e,t,l,o,d){this.title=e,this.description=t,this.priority=o,this.dueDate=l,this.targetFolder=d,le.push(this),$()}set updateTitle(e){this.title=e}set updateDescription(e){this.description=e}set updatePriority(e){this.priority=e}set updateDueDate(e){this.dueDate=e}set updateTargetFolder(e){this.targetFolder=e}updateAllData(e,t,l,o,d){this.updateTitle=e,this.updateDescription=t,this.updateDueDate=l,this.updatePriority=o,this.updateTargetFolder=d}}class Z{constructor(e){this.title=e,oe.push(this),ee()}set updateTitle(e){this.title=e}}const $=()=>{localStorage.setItem("libraryToDos",JSON.stringify(le))},ee=()=>{localStorage.setItem("libraryFolders",JSON.stringify(oe))},te=()=>{$(),ee()},le=JSON.parse(localStorage.getItem("libraryToDos"))||[],oe=JSON.parse(localStorage.getItem("libraryFolders"))||[],de=()=>{new Z("Kitchen"),new Z("House"),new Z("Gym"),new Y("Jake Mail","Send Email to Jake about upcoming project","2025-01-01","High","Inbox"),new Y("Basement","Clean trash from basement","2027-02-02","Medium","House"),new Y("Lightbulb","Replace kitchen lightbulb","2021-06-08","Low","Kitchen"),new Y("Carpet","Clean the carpet",(new Date).toISOString().split("T")[0],"Low","House"),new Y("Gym","Renew gym membership",(new Date).toISOString().split("T")[0],"Medium","Gym")};localStorage.getItem("libraryToDos")||localStorage.getItem("libraryFolders")||de(),0===le.length&&0===oe.length&&de(),q(),G(),M(),j(),R()})();