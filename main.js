(()=>{"use strict";const e=document.getElementById("projectsContainer"),t=document.getElementById("tasksContainer"),l=document.getElementById("projectsDropdown"),n=document.getElementById("Inbox"),a=document.getElementById("newItem"),o=(document.getElementById("header"),document.getElementById("modalNewPage")),i=document.getElementById("modalEditTask"),d=document.getElementById("modalEditProj"),r=(document.getElementById("modalNewMenu"),document.getElementById("modalNewTask")),s=document.getElementById("modalNewProject"),c=document.getElementById("newTaskBtn"),u=document.getElementById("newProjectBtn"),p=document.querySelectorAll(".confirm"),m=document.querySelectorAll(".confirmEdit"),g=document.querySelectorAll(".cancel"),y=document.querySelectorAll(".button-X"),E=document.getElementById("editTask"),h=document.getElementById("editProj"),v=document.querySelectorAll(".selectList");a.onclick=()=>{f(o),r.style.display="flex"},c.onclick=()=>{f(o),r.style.display="flex"},u.onclick=()=>{f(o),s.style.display="flex"},window.onclick=e=>{let t=e.target==o,l=e.target==i,n=e.target==d;(t||l||n)&&f()},y.forEach((e=>{e.onclick=()=>{f()}})),g.forEach((e=>{e.onclick=()=>{f(),C()}}));const f=e=>{o.style.display="none",r.style.display="none",s.style.display="none",i.style.display="none",d.style.display="none",void 0!==e&&(e.style.display="flex")};p.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;""==t[0].value?alert("No task name provided!"):"modalNewTask"==t.id?j(t):"modalNewProject"==t.id&&x(t)}})),m.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;console.log(t),""==t[0].value?alert("No task name provided!"):"editTask"==t.id?I(t):"editProj"==t.id&&k(t)}}));const I=e=>{let t=e.className.split("__"),l=K.findIndex((e=>e.title===t[0]&&e.targetProject===t[1]));K[l].updateAllData(e[0].value,e[1].value,e[2].value,e[3].value,e[4].value),q(),B()},k=e=>{console.log(e);let t=Q.findIndex((t=>t.title===e.className));Q[t].updateTitle=e[0].value,K.forEach((t=>{t.targetProject===e.className&&(t.updateTargetProject=e[0].value)})),q(),P()};n.addEventListener("click",(e=>{L(e.target.id),R(),B(),P()})),l.onclick=()=>{e.classList.toggle("show")};const j=e=>{let t=e[0].value,l=e[1].value,n=e[2].value,a=e[3].value,o=e[4].value,i=e[2].value.split(/[\s\,\.\-]+/);w(i[0],i[1],i[2])&&(new X(t,l,n,a,o),q(),B())},w=(e,t,l)=>{let n=new Date;return null==e||null==t||null==l?(alert("No date provided"),!1):e<n.getFullYear()||e>9999?(alert("Wrong year"),!1):t<1||t>12?(alert("Wrong month"),!1):!(l<1||l>n.getDate())||(alert("Wrong day"),!1)},x=e=>{new F(e[0].value),q(),O(),P()},P=()=>{e.innerHTML="",Q.forEach((t=>{e.append(T(t))}))},B=()=>{t.innerHTML="";let e=document.createElement("h3");e.textContent=N,t.append(e),"Inbox"==N?K.forEach((e=>{t.append(b(e))})):D(N).forEach((e=>{t.append(b(e))}))};let N=t.className;const L=e=>{t.className=e,N=e},D=e=>K.filter((t=>t.targetProject==e)),S=e=>{let t=document.createElement("p");return t.textContent=e,t},b=e=>{let t=document.createElement("div");t.id="task__"+e.title+"__"+e.targetProject,t.classList.add("task");let l=document.createElement("div");return l.append(S(e.title)),l.append(S(e.description)),l.append(S(e.dueDate)),l.append(S(e.priority)),l.append(S(e.targetProject)),t.append(l),t.append(A()),t.append(_()),t},T=e=>{let t=document.createElement("div");t.id="project__"+e.title,t.classList.add("project");let l=document.createElement("button");return l.setAttribute("type","button"),l.textContent=e.title,l.addEventListener("click",(()=>{L(e.title),B()})),t.append(l),t.append(A()),t.append(_()),t},_=()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("deleteBtn"),e.textContent="Dlt",e.addEventListener("click",(e=>{J(e.target.parentElement),Y()})),e},A=()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("editBtn"),e.textContent="Edit",e.addEventListener("click",(e=>{M(e.target.parentElement),Y()})),e},C=()=>{document.querySelectorAll("form").forEach((e=>{e.reset()}))},q=()=>{Y(),f(),C()},J=e=>{let t=e.id.split("__");if("task"==t[0]){let e=K.findIndex((e=>e.title===t[1]&&e.targetProject===t[2]));K.splice(e,1)}else if("project"==t[0]){let e=Q.findIndex((e=>e.title===t[1]));Q.splice(e,1)}e.remove()},M=e=>{let t=e.id.split("__");if("task"==t[0]){let e=K.find((e=>e.title===t[1]&&e.targetProject===t[2]));H(e),i.style.display="flex",E.className=t[1]+"__"+t[2]}else if("project"==t[0]){let e=Q.find((e=>e.title===t[1]));W(e),d.style.display="flex",h.className=t[1]}},O=()=>{v.forEach((e=>{e.innerHTML="";let t=document.createElement("option");t.value="Inbox",t.textContent="Inbox",e.append(t),Q.forEach((t=>{let l=document.createElement("option");l.value=t.title,l.textContent=t.title,e.append(l)}))}))},H=e=>{E[0].value=e.title,E[1].value=e.description,E[2].value=e.dueDate,E[3].value=e.priority,O()},W=e=>{h[0].value=e.title};class F{constructor(e){this.title=e,Q.push(this),G()}set updateTitle(e){this.title=e}}class X{constructor(e,t,l,n,a){this.title=e,this.description=t,this.priority=n,this.dueDate=l,this.targetProject=a,K.push(this),z()}set updateTitle(e){this.title=e}set updateDescription(e){this.description=e}set updatePriority(e){this.priority=e}set updateDueDate(e){this.dueDate=e}set updateTargetProject(e){this.targetProject=e}updateAllData(e,t,l,n,a){this.updateTitle=e,this.updateDescription=t,this.updateDueDate=l,this.updatePriority=n,this.targetProject=a}}const Y=()=>{G(),z()},z=()=>{localStorage.setItem("tasksList",JSON.stringify(K))},G=()=>{localStorage.setItem("projectsList",JSON.stringify(Q))},K=JSON.parse(localStorage.getItem("tasksList"))||[],Q=JSON.parse(localStorage.getItem("projectsList"))||[],R=()=>{new F("11"),new F("As"),new F("as"),new X("555","555","2022-01-01","high","Inbox"),new X("666","666","2024-04-04","medium","11"),new X("888","888","2026-07-07","low","As"),new X("888","777","2028-10-10","medium","as"),new X("989","989","2028-10-10","low","as")};localStorage.getItem("tasksList")||localStorage.getItem("projectsList")||R(),P(),B(),C(),O()})();