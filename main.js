(()=>{"use strict";const e=document.getElementById("projectsContainer"),t=document.getElementById("tasksContainer"),n=document.getElementById("projectsDropdown"),l=document.getElementById("Inbox"),a=document.getElementById("Today"),i=document.getElementById("Week"),o=document.getElementById("newItem"),r=(document.getElementById("header"),document.getElementById("modalNewPage")),d=document.getElementById("modalEditTask"),s=document.getElementById("modalEditProj"),c=(document.getElementById("modalNewMenu"),document.getElementById("modalNewTask")),u=document.getElementById("modalNewProject"),m=document.getElementById("newTaskBtn"),p=document.getElementById("newProjectBtn"),g=document.querySelectorAll(".confirm"),y=document.querySelectorAll(".confirmEdit"),E=document.querySelectorAll(".cancel"),h=document.querySelectorAll(".button-X"),f=document.getElementById("editTask"),v=document.getElementById("editProj"),k=document.querySelectorAll(".selectList");o.onclick=()=>{I(r),c.style.display="flex"},m.onclick=()=>{I(r),c.style.display="flex"},p.onclick=()=>{I(r),u.style.display="flex"},window.onclick=e=>{let t=e.target==r,n=e.target==d,l=e.target==s;(t||n||l)&&I()},h.forEach((e=>{e.onclick=()=>{I()}})),E.forEach((e=>{e.onclick=()=>{I(),H()}}));const I=e=>{r.style.display="none",c.style.display="none",u.style.display="none",d.style.display="none",s.style.display="none",void 0!==e&&(e.style.display="flex")};g.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;""==t[0].value?alert("No task name provided!"):"modalNewTask"==t.id?Q.find((e=>e.title===t[0].value))?alert("Task already exists! Provide unique name."):x(t):"modalNewProject"==t.id&&(U.find((e=>e.title===t[0].value))?alert("Project already exists! Provide unique name."):B(t))}})),y.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;""==t[0].value?alert("No task name provided!"):"editTask"==t.id?w(t):"editProj"==t.id&&j(t)}}));const w=e=>{let t=e.className.split("__"),n=Q.findIndex((e=>e.title===t[0]&&e.targetProject===t[1]));Q[n].updateAllData(e[0].value,e[1].value,e[2].value,e[3].value,e[4].value),J(),L()},j=e=>{let t=U.findIndex((t=>t.title===e.className));U[t].updateTitle=e[0].value,Q.forEach((t=>{t.targetProject===e.className&&(t.updateTargetProject=e[0].value)})),J(),L(),b()};l.addEventListener("click",(e=>{T(e.target.id),L()})),a.addEventListener("click",(e=>{T(e.target.id),L()})),i.addEventListener("click",(e=>{T(e.target.id),L()})),n.onclick=()=>{e.classList.toggle("show")};const x=e=>{let t=e[0].value,n=e[1].value,l=e[2].value,a=e[3].value,i=e[4].value;P(l)&&(new z(t,n,l,a,i),J(),L())},P=e=>{let t=e.split(/[\s\,\.\-]+/),n=t[0],l=t[1].padStart(2,0),a=t[2].padStart(2,0),i=new Date;return null==n||null==l||null==a?(alert("Wrong date format"),!1):n<i.getFullYear()||n>9999?(alert("Wrong year"),!1):l<1||l>12?(alert("Wrong month"),!1):!(a<1||a>new Date(n,l,0).getDate())||(alert("Wrong day"),!1)},B=e=>{new R(e[0].value),J(),W(),b()},b=()=>{e.innerHTML="",U.forEach((t=>{e.append(C(t))}))},L=()=>{t.innerHTML="";let e=document.createElement("h3");e.textContent=S,t.append(e),D().forEach((e=>{t.append(_(e))}))};let S=t.className;const T=e=>{S=e},D=()=>{let e=new Date,t=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0],n=[];return"Inbox"===S?Q:"Today"===S?(n=Q.filter((e=>e.dueDate==t)),n):(n=Q.filter((e=>e.targetProject===S)),n)},N=e=>{let t=document.createElement("p");return t.textContent=e,t},_=e=>{let t=document.createElement("div");t.id="task__"+e.title+"__"+e.targetProject,t.classList.add("task");let n=document.createElement("div");return n.append(N(e.title)),n.append(N(e.description)),n.append(N(e.dueDate)),n.append(N(e.priority)),n.append(N(e.targetProject)),t.append(n),t.append(A()),t.append(q()),t},C=e=>{let t=document.createElement("div");t.id="project__"+e.title;let n=document.createElement("button");return n.setAttribute("type","button"),n.classList.add("project"),n.textContent=e.title,n.addEventListener("click",(()=>{T(e.title),L()})),t.append(n),t.append(A()),t.append(q()),t},A=()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("deleteBtn"),e.textContent="Dlt",e.addEventListener("click",(e=>{O(e.target.parentElement),F()})),e},q=()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("editBtn"),e.textContent="Edit",e.addEventListener("click",(e=>{M(e.target.parentElement),F()})),e},H=()=>{document.querySelectorAll("form").forEach((e=>{e.reset()}))},J=()=>{F(),I(),H()},O=e=>{let t=e.id.split("__");if("task"==t[0]){let e=Q.findIndex((e=>e.title===t[1]&&e.targetProject===t[2]));Q.splice(e,1)}else if("project"==t[0]){let e=U.findIndex((e=>e.title===t[1]));U.splice(e,1)}e.remove()},M=e=>{let t=e.id.split("__");if("task"==t[0]){let e=Q.find((e=>e.title===t[1]&&e.targetProject===t[2]));G(e),d.style.display="flex",f.className=t[1]+"__"+t[2]}else if("project"==t[0]){let e=U.find((e=>e.title===t[1]));K(e),s.style.display="flex",v.className=t[1]}},W=()=>{k.forEach((e=>{e.innerHTML="";let t=document.createElement("option");t.value="Inbox",t.textContent="Inbox",e.append(t),U.forEach((t=>{let n=document.createElement("option");n.value=t.title,n.textContent=t.title,e.append(n)}))}))},G=e=>{f[0].value=e.title,f[1].value=e.description,f[2].value=e.dueDate,f[3].value=e.priority,W()},K=e=>{v[0].value=e.title};class R{constructor(e){this.title=e,U.push(this),Y()}set updateTitle(e){this.title=e}}class z{constructor(e,t,n,l,a){this.title=e,this.description=t,this.priority=l,this.dueDate=n,this.targetProject=a,Q.push(this),X()}set updateTitle(e){this.title=e}set updateDescription(e){this.description=e}set updatePriority(e){this.priority=e}set updateDueDate(e){this.dueDate=e}set updateTargetProject(e){this.targetProject=e}updateAllData(e,t,n,l,a){this.updateTitle=e,this.updateDescription=t,this.updateDueDate=n,this.updatePriority=l,this.targetProject=a}}const F=()=>{Y(),X()},X=()=>{localStorage.setItem("tasksList",JSON.stringify(Q))},Y=()=>{localStorage.setItem("projectsList",JSON.stringify(U))},Q=JSON.parse(localStorage.getItem("tasksList"))||[],U=JSON.parse(localStorage.getItem("projectsList"))||[],V=()=>{new R("Kitchen"),new R("House"),new R("Gym"),new z("Jake Mail","Send Email to Jake about upcoming project","2025-01-01","high","Inbox"),new z("Basement","Clean trash from basement","2027-02-02","medium","House"),new z("Lightbulb","Replace kitchen lightbulb","2021-06-08","low","Kitchen"),new z("Carpet","Clean the carpet","2021-06-01","low","House"),new z("Gym","Renew gym membership","2029-05-05","medium","Gym")};localStorage.getItem("tasksList")||localStorage.getItem("projectsList")||V(),0===Q.length&&0===U.length&&V(),b(),L(),H(),W()})();