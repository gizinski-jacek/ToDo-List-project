(()=>{"use strict";const e=document.getElementById("projectsContainer"),t=document.getElementById("tasksContainer"),l=document.getElementById("projectsDropdown"),a=document.getElementById("Inbox"),n=document.getElementById("Today"),i=document.getElementById("Week"),r=document.getElementById("newItem"),o=(document.getElementById("header"),document.getElementById("modalNewPage")),d=document.getElementById("modalEditTask"),s=document.getElementById("modalEditProj"),c=(document.getElementById("modalNewMenu"),document.getElementById("modalNewTask")),u=document.getElementById("modalNewProject"),m=document.getElementById("newTaskBtn"),p=document.getElementById("newProjectBtn"),g=document.querySelectorAll(".confirm"),y=document.querySelectorAll(".confirmEdit"),E=document.querySelectorAll(".cancel"),h=document.querySelectorAll(".button-X"),f=document.getElementById("editTask"),v=document.getElementById("editProj"),I=document.querySelectorAll(".selectList");r.onclick=()=>{k(o),c.style.display="flex"},m.onclick=()=>{k(o),c.style.display="flex"},p.onclick=()=>{k(o),u.style.display="flex"},window.onclick=e=>{let t=e.target==o,l=e.target==d,a=e.target==s;(t||l||a)&&k()},h.forEach((e=>{e.onclick=()=>{k()}})),E.forEach((e=>{e.onclick=()=>{k(),O()}}));const k=e=>{o.style.display="none",c.style.display="none",u.style.display="none",d.style.display="none",s.style.display="none",void 0!==e&&(e.style.display="flex")};g.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;""==t[0].value?alert("No task name provided!"):"modalNewTask"==t.id?Q.find((e=>e.title===t[0].value))?alert("Task already exists! Provide unique name."):S(t):"modalNewProject"==t.id&&(U.find((e=>e.title===t[0].value))?alert("Project already exists! Provide unique name."):P(t))}})),y.forEach((e=>{e.onclick=e=>{let t=e.target.parentElement.parentElement;""==t[0].value?alert("No task name provided!"):"editTask"==t.id?w(t):"editProj"==t.id&&j(t)}}));const w=e=>{let t=e.className.split("__"),l=Q.findIndex((e=>e.title===t[0]&&e.targetProject===t[1]));Q[l].updateAllData(e[0].value,e[1].value,e[2].value,e[3].value,e[4].value),H(),T()},j=e=>{let t=U.findIndex((t=>t.title===e.className));U[t].updateTitle=e[0].value,Q.forEach((t=>{t.targetProject===e.className&&(t.updateTargetProject=e[0].value)})),H(),T(),B()};a.addEventListener("click",(e=>{D(e.target.id),T()})),n.addEventListener("click",(e=>{D(e.target.id),T()})),i.addEventListener("click",(e=>{D(e.target.id),T()})),l.onclick=()=>{e.classList.toggle("show")};const S=e=>{let t=e[0].value,l=e[1].value,a=e[2].value,n=e[3].value,i=e[4].value;L(a)&&(new z(t,l,a,n,i),H(),T())},L=e=>{let t=e.split(/[\s\,\.\-]+/),l=t[0],a=t[1].padStart(2,0),n=t[2].padStart(2,0),i=new Date;return null==l||null==a||null==n?(alert("Wrong date format"),!1):l<i.getFullYear()||l>9999?(alert("Wrong year"),!1):a<1||a>12?(alert("Wrong month"),!1):!(n<1||n>new Date(l,a,0).getDate())||(alert("Wrong day"),!1)},P=e=>{new R(e[0].value),H(),W(),B()},B=()=>{e.innerHTML="",U.forEach((t=>{e.append(A(t))}))},T=()=>{t.innerHTML="";let e=document.createElement("h3");e.textContent=x,t.append(e),N().forEach((e=>{t.append(_(e))}))};let x=t.className;const D=e=>{x=e},N=()=>{let e=new Date,t=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0],l=[];return"Inbox"===x?Q:"Today"===x?(l=Q.filter((e=>e.dueDate==t)),l):(l=Q.filter((e=>e.targetProject===x)),l)},b=e=>{let t=document.createElement("p");return t.textContent=e,t},_=e=>{let t=document.createElement("div");t.id="task__"+e.title+"__"+e.targetProject,t.classList.add("task","priority"+e.priority);let l=document.createElement("div");return l.append(b(e.title)),l.append(b(e.description)),l.append(b(e.dueDate)),l.append(b(e.priority)),l.append(b(e.targetProject)),t.append(l),t.append(C()),t.append(q()),t},A=e=>{let t=document.createElement("div");return t.id="project__"+e.title,t.textContent=e.title,t.classList.add("project"),t.addEventListener("click",(()=>{D(e.title),T()})),t.append(C()),t.append(q()),t},C=()=>{const e=document.createElement("input");return e.setAttribute("type","image"),e.classList.add("deleteBtn"),e.src="imgs/delete-64.png",e.alt="Delete",e.addEventListener("click",(e=>{M(e.target.parentElement),F()})),e},q=()=>{const e=document.createElement("input");return e.setAttribute("type","image"),e.classList.add("editBtn"),e.src="imgs/edit-64.png",e.alt="Edit",e.addEventListener("click",(e=>{J(e.target.parentElement),F()})),e},O=()=>{document.querySelectorAll("form").forEach((e=>{e.reset()}))},H=()=>{F(),k(),O()},M=e=>{let t=e.id.split("__");if("task"==t[0]){let e=Q.findIndex((e=>e.title===t[1]&&e.targetProject===t[2]));Q.splice(e,1)}else if("project"==t[0]){let e=U.findIndex((e=>e.title===t[1]));U.splice(e,1)}e.remove()},J=e=>{let t=e.id.split("__");if("task"==t[0]){let e=Q.find((e=>e.title===t[1]&&e.targetProject===t[2]));G(e),d.style.display="flex",f.className=t[1]+"__"+t[2]}else if("project"==t[0]){let e=U.find((e=>e.title===t[1]));K(e),s.style.display="flex",v.className=t[1]}},W=()=>{I.forEach((e=>{e.innerHTML="";let t=document.createElement("option");t.value="Inbox",t.textContent="Inbox",e.append(t),U.forEach((t=>{let l=document.createElement("option");l.value=t.title,l.textContent=t.title,e.append(l)}))}))},G=e=>{f[0].value=e.title,f[1].value=e.description,f[2].value=e.dueDate,f[3].value=e.priority,W()},K=e=>{v[0].value=e.title};class R{constructor(e){this.title=e,U.push(this),Y()}set updateTitle(e){this.title=e}}class z{constructor(e,t,l,a,n){this.title=e,this.description=t,this.priority=a,this.dueDate=l,this.targetProject=n,Q.push(this),X()}set updateTitle(e){this.title=e}set updateDescription(e){this.description=e}set updatePriority(e){this.priority=e}set updateDueDate(e){this.dueDate=e}set updateTargetProject(e){this.targetProject=e}updateAllData(e,t,l,a,n){this.updateTitle=e,this.updateDescription=t,this.updateDueDate=l,this.updatePriority=a,this.targetProject=n}}const F=()=>{Y(),X()},X=()=>{localStorage.setItem("tasksList",JSON.stringify(Q))},Y=()=>{localStorage.setItem("projectsList",JSON.stringify(U))},Q=JSON.parse(localStorage.getItem("tasksList"))||[],U=JSON.parse(localStorage.getItem("projectsList"))||[],V=()=>{new R("Kitchen"),new R("House"),new R("Gym"),new z("Jake Mail","Send Email to Jake about upcoming project","2025-01-01","High","Inbox"),new z("Basement","Clean trash from basement","2027-02-02","Medium","House"),new z("Lightbulb","Replace kitchen lightbulb","2021-06-08","Low","Kitchen"),new z("Carpet","Clean the carpet",(new Date).toISOString().split("T")[0],"Low","House"),new z("Gym","Renew gym membership",(new Date).toISOString().split("T")[0],"Medium","Gym")};localStorage.getItem("tasksList")||localStorage.getItem("projectsList")||V(),0===Q.length&&0===U.length&&V(),B(),T(),O(),W()})();